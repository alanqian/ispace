<% content_for_title :index %>

<div id="stores-list">
  <%= simple_form_for(store_new, method: "patch", remote: true,
                      data: { url: store_path(store_new) },
                      html: { id: "stores-form", class: "inplace" }) do |f| %>
    <div class="inputs">
      <%#= f.input :region_id, collection: Region.all %>
      <%= f.input :code  %>
      <%= f.input :name %>
      <%= f.input :area %>
      <%= f.input :location  %>
      <%#= f.input :ref_store_id, collection: Store.model_store  %>
      <%#= f.input :memo %>
    </div>
    <table id="stores-table"
      data-form="#stores-form"
      data-sinfoempty="请重新搜索"
      class="dataTable grid-control no-wrap resizable inplace_edit" cellspacing=0>
      <thead>
        <tr>
          <%= data_th_list(:store,
            :code,
            ["分公司", input: false],
            ["片区", input: false],
            :name,
            :area,
            :depot_area,
            :location,
            :grade # [ :ref_store_id, sort: false ],
            ) %>
        </tr>
      </thead>
      <tbody>
        <%
          stores_hash = @stores.to_hash(:id, :name)
          regions_hash = @regions.to_hash(:code, :name)
        %>
        <% @stores.each do |store| %>
          <%= render 'item', store: store,
            stores_hash: stores_hash, regions_hash: regions_hash %>
        <% end %>
      </tbody>
    </table>
  <% end %>

</div>

<br>

<div id="dataTable-filter">
  <%= link_to simple_title(:new), new_store_path %>
</div>

